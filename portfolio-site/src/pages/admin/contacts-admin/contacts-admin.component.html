<h2 class="text-2xl font-bold mb-6  text-accentDark">Contact Messages</h2>

<div class="bg-white rounded shadow overflow-x-auto">
  <table class="min-w-full text-left">
    <thead class="bg-gray-100 text-gray-600 text-sm uppercase">
      <tr>
        <th class="px-4 py-3">#</th>
        <th class="px-4 py-3">Name</th>
        <th class="px-4 py-3">Email</th>
        <th class="px-4 py-3">Message</th>
        <th class="px-4 py-3">Created</th>
        <th class="px-4 py-3">Status</th>
        <th class="px-4 py-3 text-right">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y  text-accentDark">
      <tr *ngFor="let m of messages; let i = index">
        <td class="px-4 py-3">{{ i + 1 }}</td>
        <td class="px-4 py-3 font-medium">{{ m.name }}</td>
        <td class="px-4 py-3">{{ m.email }}</td>
        <td class="px-4 py-3 truncate max-w-xs">{{ m.message }}</td>
        <td class="px-4 py-3">{{ m.createdAt | date:'short' }}</td>
        <td class="px-4 py-3">
          <span
            class="px-2 py-1 rounded text-xs"
            [ngClass]="m.isReplied ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'">
            {{ m.isReplied ? 'Cevaplandı' : 'Bekliyor' }}
          </span>
        </td>
        <td class="px-4 py-3 text-right">
          <button class="px-3 py-1 rounded bg-blue-600 text-white" (click)="viewDetail(m)">Detay</button>
        </td>
      </tr>

      <tr *ngIf="messages.length === 0">
        <td colspan="7" class="px-4 py-6 text-center text-gray-500">Mesaj yok</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Detail & Reply Panel -->
<div
  *ngIf="selected"
  class="fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50">
  <div class="bg-white w-full max-w-2xl rounded shadow p-6  text-accentDark">
    <h3 class="text-xl font-bold mb-4">Mesaj Detayı</h3>

    <div class="space-y-2 mb-4">
      <div><span class="font-semibold">Ad:</span> {{ selected?.name }}</div>
      <div><span class="font-semibold">Email:</span> {{ selected?.email }}</div>
      <div><span class="font-semibold">Gönderim:</span> {{ selected?.createdAt | date:'short' }}</div>
      <div>
        <span class="font-semibold">Mesaj:</span>
        <p class="mt-1 whitespace-pre-line">{{ selected?.message }}</p>
      </div>
      <div *ngIf="selected?.isReplied" class="bg-green-50 border border-green-200 p-3 rounded">
        <p class="text-sm text-green-700">Cevaplandı: {{ selected?.repliedAt | date:'short' }}</p>
        <pre class="mt-1 text-sm whitespace-pre-line">{{ selected?.adminReply }}</pre>
      </div>
    </div>

    <h4 class="text-lg font-semibold mb-2">Yanıtla</h4>
    <textarea [(ngModel)]="replyText" rows="4" class="border p-2 w-full rounded"></textarea>

    <div class="flex justify-end space-x-2 mt-4">
      <button class="px-4 py-2 rounded bg-gray-300" (click)="closeDetail()">Kapat</button>
      <button class="px-4 py-2 rounded bg-blue-600 text-white" (click)="sendReply()">Gönder</button>
    </div>
  </div>
</div>
